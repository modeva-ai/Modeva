
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Performance and Residual Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../_static/theme_override.css?v=578d8e15" />
    <link rel="stylesheet" type="text/css" href="../../../_static/hide_links.css?v=60d22a59" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=a6e25548" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_source/user_guide/testing/performance';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Weakness Detection" href="weakspot.html" />
    <link rel="prev" title="Diagnostic Suite" href="../testing.html" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.9" />
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="MoDeVa">
  <meta property="og:description" content="An Integrated Tool for Model Development and Validation">
  <meta property="og:image" content="_static/logo-text.jpg">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SMVZ23N4JL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-SMVZ23N4JL');
  </script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.jpg" class="logo__image only-light" alt=""/>
    <img src="../../../_static/logo.jpg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Modeva-AI</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../usage.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api_ref.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../galleries.html">
    Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changes.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/modeva-ai/Modeva" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/Modeva" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../install.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../usage.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api_ref.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../galleries.html">
    Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changes.html">
    Changelog
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/modeva-ai/Modeva" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/Modeva" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelwrapping.html">Model Wrapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explain.html">Model Explainability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Interpretable Models</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../testing.html">Diagnostic Suite</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Performance and Residual Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="weakspot.html">Weakness Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="overfit.html">Underfitting and Overfitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="reliability.html">Reliability</a></li>
<li class="toctree-l2"><a class="reference internal" href="robustness.html">Robustness</a></li>
<li class="toctree-l2"><a class="reference internal" href="resilience.html">Resilience</a></li>
<li class="toctree-l2"><a class="reference internal" href="fairness.html">Fairness</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../low_code.html">Low code</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../usage.html" class="nav-link">Using Modeva</a></li>
    
    
    <li class="breadcrumb-item"><a href="../testing.html" class="nav-link">Diagnostic Suite</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Performance and Residual Analysis</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="performance-and-residual-analysis">
<h1>Performance and Residual Analysis<a class="headerlink" href="#performance-and-residual-analysis" title="Link to this heading">#</a></h1>
<p>Measuring the performance of a machine learning model is critical for understanding its accuracy, reliability, and suitability for real-world applications. Proper evaluation ensures that the model meets its intended objectives, generalizes well to unseen data, and operates effectively under practical conditions.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p><strong>Why Measure Model Performance?</strong></p>
<ol class="arabic simple">
<li><p><strong>Accuracy Assessment:</strong>
- Quantify how well the model predicts outcomes for unseen data.</p></li>
<li><p><strong>Comparison of Models:</strong>
- Select the best-performing model among multiple candidates.</p></li>
<li><p><strong>Bias and Variance Analysis:</strong>
- Detect overfitting (high variance) or underfitting (high bias).</p></li>
<li><p><strong>Business Impact:</strong>
- Translate performance metrics into actionable insights, such as improved decision-making or cost reduction.</p></li>
</ol>
<p><strong>Key Concepts in Model Performance Measurement</strong></p>
<ol class="arabic">
<li><p><strong>Evaluation Metrics</strong>:
- Metrics depend on the type of task:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Classification:</strong> Accuracy, precision, recall, F1-score, AUC-ROC.</p></li>
<li><p><strong>Regression:</strong> Mean squared error (MSE), mean absolute error (MAE), R-squared.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Data Splitting:</strong>
- Split the dataset into training, validation, and testing subsets for reliable evaluation.</p></li>
<li><p><strong>Cross-Validation:</strong>
- Use k-fold cross-validation to estimate performance across multiple data splits.</p></li>
<li><p><strong>Real-World Validation:</strong>
- Test the model with data that simulates real-world scenarios, such as temporal validation or external datasets.</p></li>
</ol>
</section>
<section id="classification-metrics">
<h2>Classification Metrics<a class="headerlink" href="#classification-metrics" title="Link to this heading">#</a></h2>
<p><strong>Accuracy:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{Accuracy} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}}\]</div>
<p>Measures the proportion of correctly classified samples.</p>
</div></blockquote>
<p><strong>Precision:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{Precision} = \frac{\text{TP}}{\text{TP} + \text{FP}}\]</div>
<p>Evaluates the proportion of true positives among predicted positives.</p>
</div></blockquote>
<p><strong>Recall (Sensitivity):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{Recall} = \frac{\text{TP}}{\text{TP} + \text{FN}}\]</div>
<p>Measures the proportion of true positives among all actual positives.</p>
</div></blockquote>
<p><strong>F1-Score:</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{F1-Score} = 2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}\]</div>
<p>Harmonic mean of precision and recall.</p>
</div></blockquote>
<p><strong>Area Under the Curve (AUC-ROC):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{AUC-ROC} = \int_{0}^{1} TPR(FPR^{-1}(x)) dx\]</div>
<p>Measures the ability of the model to distinguish between classes, plotting the True Positive Rate (TPR) against the False Positive Rate (FPR) across thresholds. A value of 1.0 represents perfect classification.</p>
</div></blockquote>
<p><strong>Log Loss (Cross-Entropy Loss):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{Log Loss} = -\frac{1}{n} \sum_{i=1}^n \left[ y_i \log(p_i) + (1 - y_i) \log(1 - p_i) \right]\]</div>
<p>Where:
- <span class="math notranslate nohighlight">\(y_i\)</span>: True label (1 for positive, 0 for negative).
- <span class="math notranslate nohighlight">\(p_i\)</span>: Predicted probability for the positive class.</p>
<p>Log Loss penalizes predictions that are confident but incorrect. Lower values indicate better performance.</p>
</div></blockquote>
<p><strong>Brier Score</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{Brier Score} = \frac{1}{n} \sum_{i=1}^n (p_i - y_i)^2\]</div>
<p>Evaluates the accuracy of predicted probabilities, where <span class="math notranslate nohighlight">\(p_i\)</span> is the predicted probability for the positive class, and <span class="math notranslate nohighlight">\(y_i\)</span> is the true label (1 for positive, 0 for negative). Lower values indicate better performance.</p>
</div></blockquote>
</section>
<section id="regression-metrics">
<h2>Regression Metrics<a class="headerlink" href="#regression-metrics" title="Link to this heading">#</a></h2>
<p><strong>Mean Squared Error (MSE):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{MSE} = \frac{1}{n} \sum_{i=1}^n (\hat{y}_i - y_i)^2\]</div>
<p>Average squared difference between predictions (<span class="math notranslate nohighlight">\(\hat{y}\)</span>) and actual values (<span class="math notranslate nohighlight">\(y\)</span>).</p>
</div></blockquote>
<p><strong>Mean Absolute Error (MAE):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{MAE} = \frac{1}{n} \sum_{i=1}^n |\hat{y}_i - y_i|\]</div>
<p>Average absolute difference between predictions and actual values.</p>
</div></blockquote>
<p><strong>R-Squared (Coefficient of Determination):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[R^2 = 1 - \frac{\sum_{i=1}^n (\hat{y}_i - y_i)^2}{\sum_{i=1}^n (y_i - \bar{y})^2}\]</div>
<p>Proportion of variance in the target variable explained by the model.</p>
</div></blockquote>
<p><strong>Mean Average Precision (MAP):</strong></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\text{MAP} = \frac{1}{Q} \sum_{q=1}^Q \frac{1}{m} \sum_{k=1}^m P(k)\]</div>
<p>Averages precision at each rank position for all queries.</p>
</div></blockquote>
<section id="challenges-in-measuring-model-performance">
<h3>Challenges in Measuring Model Performance<a class="headerlink" href="#challenges-in-measuring-model-performance" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Data Imbalance:</strong>
- Metrics like accuracy may be misleading for imbalanced datasets; consider using precision, recall, or F1-score.</p></li>
<li><p><strong>Overfitting/Underfitting:</strong>
- Overfitting occurs when the model performs well on training data but poorly on unseen data. Underfitting results from insufficient learning of patterns in the data.</p></li>
<li><p><strong>Real-World Applicability:</strong>
- The model’s performance in lab conditions may not generalize to real-world scenarios.</p></li>
</ol>
</section>
</section>
<section id="performance-evaluation-in-modeva">
<h2>Performance Evaluation in MoDeVa<a class="headerlink" href="#performance-evaluation-in-modeva" title="Link to this heading">#</a></h2>
<p><strong>Data Setup</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">modeva</span> <span class="kn">import</span> <span class="n">DataSet</span>
<span class="c1">## Create dataset object holder</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">DataSet</span><span class="p">()</span>
<span class="c1">## Loading MoDeVa pre-loaded dataset &quot;Bikesharing&quot;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;BikeSharing&quot;</span><span class="p">)</span>
<span class="c1">## Preprocess the data</span>
<span class="n">ds</span><span class="o">.</span><span class="n">scale_numerical</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;cnt&quot;</span><span class="p">,),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;log1p&quot;</span><span class="p">)</span> <span class="c1"># Log transfomed target</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_feature_type</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="s2">&quot;hr&quot;</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">)</span> <span class="c1"># set to categorical feature</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_feature_type</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="s2">&quot;mnth&quot;</span><span class="p">,</span> <span class="n">feature_type</span><span class="o">=</span><span class="s2">&quot;categorical&quot;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">scale_numerical</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">feature_names_numerical</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;standardize&quot;</span><span class="p">)</span> <span class="c1"># standardized numerical features</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_inactive_features</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;yr&quot;</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">,</span> <span class="s2">&quot;temp&quot;</span><span class="p">))</span> <span class="c1"># deactivate some features</span>
<span class="n">ds</span><span class="o">.</span><span class="n">preprocess</span><span class="p">()</span>
<span class="c1">## Split data into training and testing sets randomly</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_random_split</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Model Setup</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Regression tasks using lightGBM and xgboost</span>
<span class="kn">from</span> <span class="nn">modeva.models</span> <span class="kn">import</span> <span class="n">MoLGBMRegressor</span><span class="p">,</span> <span class="n">MoXGBRegressor</span>

<span class="c1"># for lightGBM</span>
<span class="n">model_lgbm</span> <span class="o">=</span> <span class="n">MoLGBMRegressor</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;LGBM_model&quot;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># for xgboost</span>
<span class="n">model_xgb</span> <span class="o">=</span> <span class="n">MoXGBRegressor</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;XGB_model&quot;</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="c1"># for catboost</span>
</pre></div>
</div>
<p><strong>Model Training</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># train model with input: ds.train_x and target: ds.train_y</span>
<span class="n">model_lgbm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">train_x</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">train_y</span><span class="p">)</span>
<span class="n">model_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">train_x</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">train_y</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Reporting and Diagnostic Setup</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a testsuite that bundles dataset and model</span>
<span class="kn">from</span> <span class="nn">modeva</span> <span class="kn">import</span> <span class="n">TestSuite</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TestSuite</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">model_lgbm</span><span class="p">)</span> <span class="c1"># store bundle of dataset and model in fs</span>
<span class="c1"># Evaluate performance and summarize into table</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">diagnose_accuracy_table</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">test_dataset</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
                                  <span class="n">metric</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">table</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/xgb_perf.png"><img alt="../../../_images/xgb_perf.png" class="align-center" src="../../../_images/xgb_perf.png" style="width: 300px;" />
</a>
<p>For the full list of arguments of the API see <a class="reference external" href="../../modules/generated/modeva.TestSuite.diagnose_accuracy_table.html">TestSuite.diagnose_accuracy_table</a>.</p>
</section>
<section id="residual-analysis">
<h2>Residual Analysis<a class="headerlink" href="#residual-analysis" title="Link to this heading">#</a></h2>
<p>Residual analysis is a diagnostic tool used in machine learning and statistics to evaluate the performance of a model by analyzing the differences between actual and predicted values. These differences, known as residuals, provide insights into how well the model fits the data and where it might struggle.</p>
<p>The residual for a given observation is calculated as:</p>
<div class="math notranslate nohighlight">
\[\text{Residual} = \text{Actual Value} - \text{Predicted Value}\]</div>
<p>For regression problems, the residual measures the error in the model’s prediction for each data point. For classification problems, residuals are typically expressed as misclassification errors or the difference between predicted probabilities and true labels.</p>
<section id="purpose-of-residual-analysis">
<h3>Purpose of Residual Analysis<a class="headerlink" href="#purpose-of-residual-analysis" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Model Fit:</strong>
- Identify whether the model captures the underlying patterns in the data or if there are systematic errors.</p></li>
<li><p><strong>Error Distribution:</strong>
- Check whether residuals are randomly distributed, which indicates a well-fitting model. Systematic patterns in residuals suggest that the model is underperforming or mis-specified.</p></li>
<li><p><strong>Outlier Detection:</strong>
- Detect data points where the model performs poorly.</p></li>
<li><p><strong>Heteroscedasticity:</strong>
- Examine if the variance of residuals changes across feature values, which can indicate issues like model misspecification or the need for feature transformations.</p></li>
<li><p><strong>Assumption Validation:</strong>
- Ensure that assumptions like linearity or normality of residuals hold (important for linear regression models).</p></li>
</ol>
</section>
<section id="steps-in-residual-analysis">
<h3>Steps in Residual Analysis<a class="headerlink" href="#steps-in-residual-analysis" title="Link to this heading">#</a></h3>
<ol class="arabic">
<li><p><strong>Calculate Residuals:</strong>
- For each data point, compute the difference between the actual value and the predicted value.</p></li>
<li><p><strong>Visualize Residuals:</strong>
- Use plots to analyze residual patterns:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Residual vs. Predicted Plot:</strong> Check for random distribution around zero.</p></li>
<li><p><strong>Histogram of Residuals:</strong> Assess the distribution of residuals.</p></li>
<li><p><strong>Residuals vs. Features:</strong> Identify feature-specific patterns.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Analyze Patterns:</strong>
- Look for systematic patterns, such as clustering or trends, which indicate model issues.
- Investigate high residuals (outliers) for potential data quality issues or edge cases.</p></li>
<li><p><strong>Quantify Residual Metrics:</strong>
- Use metrics like Mean Absolute Error (MAE) or Mean Squared Error (MSE) to summarize residuals.</p></li>
</ol>
</section>
<section id="techniques-for-residual-analysis">
<h3>Techniques for Residual Analysis<a class="headerlink" href="#techniques-for-residual-analysis" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Residual Plots:</strong></p>
<ul class="simple">
<li><p><strong>Residuals vs. Predicted Plot:</strong></p>
<ul>
<li><p>A good model produces a random scatter around zero.</p></li>
</ul>
</li>
<li><p><strong>Residuals vs. Features:</strong></p>
<ul>
<li><p>Highlights feature-specific weaknesses in the model.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Histogram of Residuals:</strong>
- Checks if residuals distribution, normality is often assumed in statistical models like linear regression.</p></li>
<li><p><strong>Quantile-Quantile (Q-Q) Plot:</strong>
- Assesses if residuals are normally distributed by comparing quantiles of residuals to a normal distribution.</p></li>
<li><p><strong>Cluster Analysis on Residuals:</strong>
- Group data points with high residuals to identify regions in the feature space where the model performs poorly.</p></li>
</ol>
</section>
<section id="interpreting-residual-analysis-results">
<h3>Interpreting Residual Analysis Results<a class="headerlink" href="#interpreting-residual-analysis-results" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Randomly Distributed Residuals:</strong>
- Indicates the model captures the data well, with no systematic errors.</p></li>
<li><p><strong>Systematic Patterns:</strong>
- Suggests model misspecification, such as missing features or nonlinearity.</p></li>
<li><p><strong>High Variance in Residuals:</strong>
- May indicate heteroscedasticity, where the model’s error changes depending on the feature value.</p></li>
<li><p><strong>Outliers:</strong>
- Points with large residuals could represent edge cases, noisy data, or unmodeled effects.</p></li>
</ol>
</section>
<section id="applications-of-residual-analysis">
<h3>Applications of Residual Analysis<a class="headerlink" href="#applications-of-residual-analysis" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Model Debugging:</strong>
- Identify issues in model performance, such as underfitting or overfitting.</p></li>
<li><p><strong>Feature Engineering:</strong>
- Highlight features that need transformation or additional features to improve performance.</p></li>
<li><p><strong>Outlier Detection:</strong>
- Identify unusual data points that may skew the model.</p></li>
<li><p><strong>Heteroscedasticity Testing:</strong>
- Validate assumptions of homoscedasticity in regression models.</p></li>
</ol>
<p>Residual analysis is an essential diagnostic tool for improving model performance and ensuring that the model generalizes well to unseen data. By examining residual patterns, practitioners can uncover model weaknesses, refine the model, and achieve better predictive accuracy.</p>
</section>
</section>
<section id="residual-analysis-in-modeva">
<h2>Residual Analysis in MoDeVa<a class="headerlink" href="#residual-analysis-in-modeva" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">diagnose_residual_analysis</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="s2">&quot;hr&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/xgb_Residual_plot.png"><img alt="../../../_images/xgb_Residual_plot.png" class="align-center" src="../../../_images/xgb_Residual_plot.png" style="width: 500px;" />
</a>
<p>For the full list of arguments of the API see <a class="reference external" href="../../modules/generated/modeva.TestSuite.diagnose_residual_analysis.html">TestSuite.diagnose_residual_analysis</a>.</p>
</section>
<section id="performance-comparison">
<h2>Performance Comparison<a class="headerlink" href="#performance-comparison" title="Link to this heading">#</a></h2>
<p>Performance of several models can be compared as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span> <span class="o">=</span> <span class="n">TestSuite</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">model_lgbm</span><span class="p">,</span> <span class="n">model_xgb</span><span class="p">])</span>
<span class="c1"># Performance comparison of 2 models specified in tsc</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">tsc</span><span class="o">.</span><span class="n">compare_accuracy_table</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">test_dataset</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span>
                                  <span class="n">metric</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R2&quot;</span><span class="p">))</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="side-by-side docutils container">
<a class="reference internal image-reference" href="../../../_images/Accuracy_Comparison_MSE.png"><img alt="../../../_images/Accuracy_Comparison_MSE.png" src="../../../_images/Accuracy_Comparison_MSE.png" style="width: 30%;" />
</a>
<a class="reference internal image-reference" href="../../../_images/Accuracy_Comparison_MAE.png"><img alt="../../../_images/Accuracy_Comparison_MAE.png" src="../../../_images/Accuracy_Comparison_MAE.png" style="width: 30%;" />
</a>
<a class="reference internal image-reference" href="../../../_images/Accuracy_Comparison_R2.png"><img alt="../../../_images/Accuracy_Comparison_R2.png" src="../../../_images/Accuracy_Comparison_R2.png" style="width: 30%;" />
</a>
</div>
<p>Check the API reference for detail arguments of <a class="reference external" href="../../modules/generated/modeva.TestSuite.compare_accuracy_table.html">TestSuite.compare_accuracy_table</a>.</p>
</section>
<section id="supervised-learning-for-residual-analysis">
<h2>Supervised Learning for Residual Analysis<a class="headerlink" href="#supervised-learning-for-residual-analysis" title="Link to this heading">#</a></h2>
<p>MoDeVa provides supervised machine learning approach to analyze residuals, using interpretable gradient-boosted decision trees (GBDT) with depth-1 and depth-2 constraints and random forest (RF) proximity matrices for clustering. This methodology enhances model performance by identifying regions where the errors (e.g., mean absolute error (MAE) is high), enabling targeted interventions to refine predictive accuracy.</p>
<p>Traditional unsupervised approaches, such as binning, clustering (e.g., $k$-means), or decision tree-based methods, often fail to capture complex, non-linear relationships in high-dimensional feature spaces. Instead, GBDT and RF provide a supervised framework that explicitly models residual errors, leveraging ensemble learning to better capture feature interactions and high-error regions.</p>
<p>The interpretable GBDT model enables detailed feature analysis, identifying key variables and their effects on residuals. This makes it possible to pinpoint why and where errors are occurring in the feature space. Additionally, the RF proximity matrix offers a data-driven clustering mechanism by measuring pairwise similarity between data points based on their shared leaf memberships across trees. This proximity-based clustering aligns naturally with the underlying model behavior, making the results more interpretable and actionable compared to traditional clustering approaches.</p>
<p>By combining error-focused modeling, feature importance analysis, and proximity-based clustering, this framework provides a structured way to detect high-error regions. This enables targeted feature engineering, model refinement, and localized adjustments, ultimately improving overall model reliability and robustness.</p>
<section id="methodology">
<h3>Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h3>
<p>There are two complementary methodologies available in MoDeVa:</p>
<p><strong>1. Residual Modeling Using Interpretable GBDT</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>We train an interpretable XGBoost model constrained to depth-1 and depth-2 trees, allowing us to explicitly model residuals.</p></li>
<li><p>The residuals <span class="math notranslate nohighlight">\((r = |y - \hat{y}|)\)</span> are used as the target variable in a separate regression model, where features explain where and why errors occur.</p></li>
<li><p>The depth constraint ensures that only direct feature effects (depth-1) and simple interactions (depth-2) are captured, making results interpretable.</p></li>
<li><p>Feature importance scores and effect from fANOVAare analyzed to understand which variables drive residuals the most.</p></li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">diagnose_residual_interpret</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># train interpretable GBDT model with depth-2</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;feature_importance&quot;</span><span class="p">)</span> <span class="c1"># plot feature importance</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;effect_importance&quot;</span><span class="p">)</span> <span class="c1"># plot effect importance</span>
</pre></div>
</div>
<div class="side-by-side docutils container">
<a class="reference internal image-reference" href="../../../_images/Feature_Importance_XGB_Residual_Model.png"><img alt="../../../_images/Feature_Importance_XGB_Residual_Model.png" src="../../../_images/Feature_Importance_XGB_Residual_Model.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="../../../_images/Effect_Importance_XGB_Residual_Model.png"><img alt="../../../_images/Effect_Importance_XGB_Residual_Model.png" src="../../../_images/Effect_Importance_XGB_Residual_Model.png" style="width: 45%;" />
</a>
</div>
<p>The effect plot of feature of to the residual model is shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ts_residual</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;TestSuite&quot;</span><span class="p">]</span> <span class="c1"># get the testsuite object</span>
<span class="n">ts_residual</span><span class="o">.</span><span class="n">interpret_effects</span><span class="p">(</span><span class="s2">&quot;hr&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot effect plot for feature &quot;hr&quot;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/Effect_XGB_Residual_hr.png"><img alt="../../../_images/Effect_XGB_Residual_hr.png" class="align-center" src="../../../_images/Effect_XGB_Residual_hr.png" style="width: 400px;" />
</a>
<p>To understand the local effect for a sample, we can use the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ts_residual</span><span class="o">.</span><span class="n">interpret_local_fi</span><span class="p">(</span><span class="n">sample_index</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot local feature importance for sample index 20</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/Local_FI_XGB_Residual_Model.png"><img alt="../../../_images/Local_FI_XGB_Residual_Model.png" class="align-center" src="../../../_images/Local_FI_XGB_Residual_Model.png" style="width: 500px;" />
</a>
<p><strong>2. Proximity-Based Clustering Using RF Proximity Matrix</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>A random forest model is trained on the same dataset, and the proximity matrix is extracted.</p></li>
<li><p>The proximity matrix measures pairwise similarity between data points by counting how often two points land in the same leaf across multiple trees.</p></li>
<li><p>This matrix is then used as an input to clustering algorithms, such as spectral clustering or hierarchical clustering, to group samples based on error similarity.</p></li>
<li><p>Unlike traditional clustering methods, this approach aligns clusters with the model’s behavior, making it more meaningful for residual error analysis.</p></li>
</ul>
</div></blockquote>
<p>MoDeVa code’s for this methodology is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">diagnose_residual_cluster</span><span class="p">(</span>
   <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="c1"># dataset to use</span>
   <span class="n">response_type</span><span class="o">=</span><span class="s2">&quot;abs_residual&quot;</span><span class="p">,</span> <span class="c1"># response type</span>
   <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="c1"># metric to use</span>
   <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># number of clusters</span>
   <span class="n">cluster_method</span><span class="o">=</span><span class="s2">&quot;pam&quot;</span><span class="p">,</span> <span class="c1"># clustering method</span>
   <span class="n">sample_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="c1"># sample size</span>
   <span class="n">rf_n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c1"># number of trees</span>
   <span class="n">rf_max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="c1"># max depth of trees</span>
<span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">table</span> <span class="c1"># table of cluster performance</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;cluster_residual&quot;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;cluster_performance&quot;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;feature_importance&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/Residual_RF_Table.png"><img alt="../../../_images/Residual_RF_Table.png" class="align-center" src="../../../_images/Residual_RF_Table.png" style="width: 50%;" />
</a>
<div class="side-by-side docutils container">
<a class="reference internal image-reference" href="../../../_images/Cluster_Residual.png"><img alt="../../../_images/Cluster_Residual.png" src="../../../_images/Cluster_Residual.png" style="width: 45%;" />
</a>
<a class="reference internal image-reference" href="../../../_images/Cluster_Residual_Performance.png"><img alt="../../../_images/Cluster_Residual_Performance.png" src="../../../_images/Cluster_Residual_Performance.png" style="width: 45%;" />
</a>
</div>
<a class="reference internal image-reference" href="../../../_images/Feature_Importance_RF_Residual.png"><img alt="../../../_images/Feature_Importance_RF_Residual.png" class="align-center" src="../../../_images/Feature_Importance_RF_Residual.png" style="width: 500px;" />
</a>
<p><strong>High-Error Region Identification and Interpretation</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Clusters are analyzed based on their average residual error (e.g., MAE or MSE).</p></li>
<li><p>High-error clusters are interpreted based on their feature composition, helping to uncover systematic model weaknesses.</p></li>
<li><p>By leveraging GBDT feature importance and RF-based similarity, we gain insights into how feature interactions contribute to residuals.</p></li>
<li><p>Actionable interventions, such as feature transformations, localized model adjustments, or targeted data augmentation, are then developed to mitigate errors in identified high-error regions.</p></li>
</ul>
</div></blockquote>
<p>The following code shows how to identify the high-error region and interpret the results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_id</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># cluster id</span>
<span class="n">data_results</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">data_drift_test</span><span class="p">(</span>
   <span class="o">**</span><span class="n">results</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;clusters&quot;</span><span class="p">][</span><span class="n">cluster_id</span><span class="p">][</span><span class="s2">&quot;data_info&quot;</span><span class="p">],</span> <span class="c1"># use the cluster_id</span>
   <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;PSI&quot;</span><span class="p">,</span> <span class="c1"># distance metric using PSI</span>
   <span class="n">psi_method</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="c1"># psi method using uniform distribution</span>
   <span class="n">psi_bins</span><span class="o">=</span><span class="mi">10</span> <span class="c1"># psi bins</span>
<span class="p">)</span>
<span class="n">data_results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)</span> <span class="c1"># plot summary of data drift test</span>
<span class="n">data_results</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;hr&#39;</span><span class="p">))</span> <span class="c1"># plot density plot for feature &quot;hr&quot;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/Residual_RF_PSI.png"><img alt="../../../_images/Residual_RF_PSI.png" class="align-center" src="../../../_images/Residual_RF_PSI.png" style="width: 500px;" />
</a>
<a class="reference internal image-reference" href="../../../_images/Residual_Density_hr.png"><img alt="../../../_images/Residual_Density_hr.png" class="align-center" src="../../../_images/Residual_Density_hr.png" style="width: 500px;" />
</a>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<aside class="topic">
<p class="topic-title">Example 1: Bike Sharing</p>
<blockquote>
<div><p>The example below demonstrates how to use MoDeVa with its high-code APis for the Bike Sharing dataset from the UCI repository, which consists of 20,640 samples and 9 features, fetched by sklearn.datasets. The response variable MedHouseVal (Median Home Value) is continuous and is a regression problem.</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="../../auto_galleries/val/0_residual/plot_1_residual_reg.html#sphx-glr-source-auto-galleries-val-0-residual-plot-1-residual-reg-py"><span class="std std-ref">Residual Analysis (Regression)</span></a></p></li>
<li><p><a class="reference internal" href="../../auto_galleries/val/1_performance/plot_0_accuracy_table_reg.html#sphx-glr-source-auto-galleries-val-1-performance-plot-0-accuracy-table-reg-py"><span class="std std-ref">Performance Metrics (Regression)</span></a></p></li>
</ul>
</aside>
<aside class="topic">
<p class="topic-title">Examples 2: Taiwan Credit</p>
<blockquote>
<div><p>The second example below demonstrates how to use MoDeVa’s high-code APIs for the TaiwanCredit dataset from the UCI repository. This dataset comprises the credit card details of 30,000 clients in Taiwan from April 2005 to September 2005, and more information can be found on the TaiwanCreditData website. The <cite>FlagDefault</cite> variable serves as the response for this classification problem.</p>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference internal" href="../../auto_galleries/val/0_residual/plot_1_residual_cls.html#sphx-glr-source-auto-galleries-val-0-residual-plot-1-residual-cls-py"><span class="std std-ref">Residual Analysis (Classification)</span></a></p></li>
<li><p><a class="reference internal" href="../../auto_galleries/val/1_performance/plot_0_accuracy_table_cls.html#sphx-glr-source-auto-galleries-val-1-performance-plot-0-accuracy-table-cls-py"><span class="std std-ref">Performance Metrics (Classification)</span></a></p></li>
</ul>
</aside>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../testing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Diagnostic Suite</p>
      </div>
    </a>
    <a class="right-next"
       href="weakspot.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Weakness Detection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-metrics">Classification Metrics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-metrics">Regression Metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#challenges-in-measuring-model-performance">Challenges in Measuring Model Performance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-evaluation-in-modeva">Performance Evaluation in MoDeVa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-analysis">Residual Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose-of-residual-analysis">Purpose of Residual Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-in-residual-analysis">Steps in Residual Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#techniques-for-residual-analysis">Techniques for Residual Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpreting-residual-analysis-results">Interpreting Residual Analysis Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-residual-analysis">Applications of Residual Analysis</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residual-analysis-in-modeva">Residual Analysis in MoDeVa</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-comparison">Performance Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supervised-learning-for-residual-analysis">Supervised Learning for Residual Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, Modeva Team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>